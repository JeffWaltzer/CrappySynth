<!DOCTYPE html>
<html lang="en">
<head>
    <script>
        function playSynth(note) {
            const frequencies = {
                A: 220.0,  // Frequency for A
                B: 246.94, // Frequency for B
                C: 261.63  // Frequency for C
            };
            const frequency = frequencies[note] || 220.0; // Fallback to A if note is invalid
            const selectedInstrument = document.getElementById("instrument").value;
            if (selectedInstrument === "flute") {
                fluteSound(audioContext, frequency, 2); // Play flute for 2 seconds
            } else if (selectedInstrument === "tubularBell") {
                tubularBellSound(audioContext, frequency, 2); // Play tubular bell for 2 seconds
            } else if (selectedInstrument === "guitar") {
                guitarSound(audioContext, frequency, 2); // Play guitar for 2 seconds
            }
        };

    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Physical Modeling Synthesizer</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #282c34;
            color: white;
            text-align: center;
            margin: 0;
            padding: 20px;
        }

        h1 {
            margin-bottom: 30px;
        }

        button {
            padding: 15px 30px;
            margin: 10px;
            font-size: 18px;
            color: white;
            background-color: #61dafb;
            border: none;
            cursor: pointer;
            border-radius: 5px;
        }

        button:hover {
            background-color: #21a1f1;
        }
    </style>
</head>
<body>
<h1>Physical Modeling Synthesizer</h1>
<div>
    <label for="instrument">Select Instrument:</label>
    <select id="instrument">
        <option value="flute">Flute</option>
        <option value="tubularBell">Tubular Bell</option>
        <option value="guitar">Guitar</option>
    </select>
</div>
<div>
    <button onclick="playSynth('A')">Play A</button>
    <button onclick="playSynth('B')">Play B</button>
    <button onclick="playSynth('C')">Play C</button>
</div>
<script>
    // Initialize Audio Context
    const audioContext = new (window.AudioContext || window.webkitAudioContext)();

    // Flute Sound Generation using Sine Wave
    function fluteSound(ctx, frequency, duration) {
        const oscillator = ctx.createOscillator();
        oscillator.type = "sine"; // Sine wave for smooth flute sound
        oscillator.frequency.setValueAtTime(frequency, ctx.currentTime);

        // Amplitude Envelope
        const gain = ctx.createGain();
        gain.gain.setValueAtTime(0, ctx.currentTime);
        gain.gain.linearRampToValueAtTime(0.8, ctx.currentTime + 0.1); // Attack
        gain.gain.exponentialRampToValueAtTime(0.6, ctx.currentTime + 0.3); // Decay
        gain.gain.setValueAtTime(0.6, ctx.currentTime + duration - 0.2); // Sustain
        gain.gain.linearRampToValueAtTime(0.0, ctx.currentTime + duration); // Release

        oscillator.connect(gain);
        gain.connect(ctx.destination);

        oscillator.start();
        oscillator.stop(ctx.currentTime + duration); // Stop after the specified duration
    }

    // Tubular Bell Sound Generation
    function tubularBellSound(ctx, frequency, duration) {
        const oscillator = ctx.createOscillator();
        oscillator.type = "sine"; // Basic sine wave for tubular bell
        oscillator.frequency.setValueAtTime(frequency, ctx.currentTime);
        oscillator.frequency.exponentialRampToValueAtTime(frequency * 0.99, ctx.currentTime + 0.5); // Subtle frequency drop for realism

        // Amplitude Envelope
        const gain = ctx.createGain();
        gain.gain.setValueAtTime(0, ctx.currentTime);
        gain.gain.linearRampToValueAtTime(1.0, ctx.currentTime + 0.05); // Quick attack
        gain.gain.exponentialRampToValueAtTime(0.2, ctx.currentTime + duration - 0.3); // Decay
        gain.gain.linearRampToValueAtTime(0.0, ctx.currentTime + duration); // Release

        oscillator.connect(gain);
        gain.connect(ctx.destination);

        oscillator.start();
        oscillator.stop(ctx.currentTime + duration); // Stop after specified duration
    }
    

    // Function to Play a Note
    // Guitar Sound Generation
    function guitarSound(ctx, frequency, duration) {
        const oscillator = ctx.createOscillator();
        oscillator.type = "triangle"; // Triangle wave for guitar-like sound
        oscillator.frequency.setValueAtTime(frequency, ctx.currentTime);

        // Amplitude Envelope
        const gain = ctx.createGain();
        gain.gain.setValueAtTime(0, ctx.currentTime);
        gain.gain.linearRampToValueAtTime(1.0, ctx.currentTime + 0.02); // Attack
        gain.gain.exponentialRampToValueAtTime(0.5, ctx.currentTime + 0.1); // Decay
        gain.gain.setValueAtTime(0.5, ctx.currentTime + duration - 0.2); // Sustain
        gain.gain.linearRampToValueAtTime(0.0, ctx.currentTime + duration); // Release

        // Add distortion for realism
        const distortion = ctx.createWaveShaper();
        distortion.curve = new Float32Array([0, 1, 0]); // Simple distortion curve
        distortion.oversample = '4x';

        oscillator.connect(distortion);
        distortion.connect(gain);
        gain.connect(ctx.destination);

        oscillator.start();
        oscillator.stop(ctx.currentTime + duration); // Stop after the specified duration
    }

</script>
</body>
</html>